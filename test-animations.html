<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Animations - Hybrid Mode Improvements</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/styles.css">
    <link rel="stylesheet" href="css/subject-card.css">
</head>
<body>
    <div class="container mt-4">
        <h1>Test de Animaciones - Mejoras del Modo Híbrido</h1>
        
        <!-- Test Section Expansion/Collapse -->
        <div class="card mb-4">
            <div class="card-header">
                <h3>Test: Expansión/Colapso de Secciones</h3>
            </div>
            <div class="card-body">
                <button id="toggleExpansion" class="btn btn-primary mb-3">Toggle Expansión</button>
                <div id="testSection" class="sections-container" style="display: none;">
                    <h4>Contenido de la sección</h4>
                    <p>Este contenido se expande y colapsa con animaciones suaves.</p>
                    <div class="section-item">
                        <div class="section-header">
                            <span class="section-nrc">12345</span>
                            <span class="section-sequence">Sec. 01</span>
                            <span class="section-status-badge open">✅ Abierta</span>
                        </div>
                        <div class="section-schedule">⏰ LMW 08:00-09:30</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Test Selection State Changes -->
        <div class="card mb-4">
            <div class="card-header">
                <h3>Test: Cambios de Estado de Selección</h3>
            </div>
            <div class="card-body">
                <button id="toggleSelection" class="btn btn-success mb-3">Toggle Selección</button>
                <button id="changeState" class="btn btn-warning mb-3">Cambiar Estado</button>
                <div id="testSubject" class="subject-item">
                    <div class="subject-content">
                        <div class="subject-code">COMP101</div>
                        <div class="subject-title">Introducción a la Programación</div>
                        <div class="subject-details">
                            <span class="credits-badge">3 créditos</span>
                            <span class="section-badge section-open">5 secciones abiertas</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Test Loading Indicators -->
        <div class="card mb-4">
            <div class="card-header">
                <h3>Test: Indicadores de Carga</h3>
            </div>
            <div class="card-body">
                <button id="showSpinner" class="btn btn-info me-2">Spinner</button>
                <button id="showDots" class="btn btn-info me-2">Dots</button>
                <button id="showBar" class="btn btn-info me-2">Progress Bar</button>
                <div id="loadingContainer" class="mt-3 position-relative" style="height: 100px; border: 1px dashed #ccc;">
                    <p class="text-center mt-4">Área de prueba para indicadores de carga</p>
                </div>
            </div>
        </div>

        <!-- Test Hover Effects -->
        <div class="card mb-4">
            <div class="card-header">
                <h3>Test: Efectos de Hover y Focus</h3>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col-md-4">
                        <button class="mode-toggle-btn active mb-2">Modo Toggle</button>
                    </div>
                    <div class="col-md-4">
                        <button class="expand-btn mb-2">Expandir</button>
                    </div>
                    <div class="col-md-4">
                        <button class="item-action-btn btn-outline-warning mb-2">Acción</button>
                    </div>
                </div>
                <div class="row mt-3">
                    <div class="col-md-6">
                        <input type="text" class="filter-input form-control" placeholder="Input con focus mejorado">
                    </div>
                    <div class="col-md-6">
                        <select class="filter-select form-select">
                            <option>Select con focus mejorado</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        import AnimationService from './js/services/AnimationService.js';

        // Initialize animation service
        AnimationService.init();

        // Test expansion/collapse
        let isExpanded = false;
        document.getElementById('toggleExpansion').addEventListener('click', async () => {
            const section = document.getElementById('testSection');
            
            if (!isExpanded) {
                section.style.display = 'block';
                await AnimationService.expandCollapse(section, true);
                isExpanded = true;
            } else {
                await AnimationService.expandCollapse(section, false);
                setTimeout(() => {
                    section.style.display = 'none';
                }, 300);
                isExpanded = false;
            }
        });

        // Test selection state changes
        let isSelected = false;
        let isPriority = true;
        const testSubject = document.getElementById('testSubject');

        document.getElementById('toggleSelection').addEventListener('click', async () => {
            if (!isSelected) {
                testSubject.classList.add('selected-priority');
                await AnimationService.bounce(testSubject);
                isSelected = true;
            } else {
                testSubject.classList.remove('selected-priority', 'selected-candidate');
                await AnimationService.fade(testSubject, false, { duration: 200 });
                await AnimationService.fade(testSubject, true, { duration: 200 });
                isSelected = false;
            }
        });

        document.getElementById('changeState').addEventListener('click', async () => {
            if (isSelected) {
                testSubject.classList.add('state-changing');
                
                if (isPriority) {
                    testSubject.classList.remove('selected-priority');
                    testSubject.classList.add('selected-candidate');
                } else {
                    testSubject.classList.remove('selected-candidate');
                    testSubject.classList.add('selected-priority');
                }
                
                await AnimationService.stateTransition(testSubject, 
                    isPriority ? 'selected-priority' : 'selected-candidate',
                    isPriority ? 'selected-candidate' : 'selected-priority'
                );
                
                testSubject.classList.remove('state-changing');
                isPriority = !isPriority;
            }
        });

        // Test loading indicators
        const loadingContainer = document.getElementById('loadingContainer');
        let currentIndicator = null;

        document.getElementById('showSpinner').addEventListener('click', () => {
            if (currentIndicator) currentIndicator.remove();
            currentIndicator = AnimationService.createLoadingIndicator(loadingContainer, {
                type: 'spinner',
                text: 'Cargando con spinner...'
            });
        });

        document.getElementById('showDots').addEventListener('click', () => {
            if (currentIndicator) currentIndicator.remove();
            currentIndicator = AnimationService.createLoadingIndicator(loadingContainer, {
                type: 'dots',
                text: 'Cargando con dots...'
            });
        });

        document.getElementById('showBar').addEventListener('click', () => {
            if (currentIndicator) currentIndicator.remove();
            currentIndicator = AnimationService.createLoadingIndicator(loadingContainer, {
                type: 'bar',
                text: 'Cargando con barra...'
            });
        });

        // Auto-remove loading indicators after 3 seconds
        setInterval(() => {
            if (currentIndicator) {
                currentIndicator.remove();
                currentIndicator = null;
            }
        }, 3000);
    </script>
</body>
</html>